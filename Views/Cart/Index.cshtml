@model EpicBookstoreSprint.Models.Cart

<h1>Cart</h1>

@if (Model.cartItems.Count > 0)
{
    <div class="table-responsive">
        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th scope="col">Image</th>
                    <th scope="col">Book</th>
                    <th scope="col">Price</th>
                    <th scope="col">Quantity</th>
                    <th scope="col">Total</th>
                    <th scope="col">Remove</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model.cartItems)
                {
                    var bookTotal = item.books.Price * item.Quantity;
                    <tr>
                        <td>
                            <a class="a-cleanup" asp-controller="Store" asp-action="Details" asp-route-id="@item.Id">
                                <img src="data:image/png;base64,@Convert.ToBase64String(item.books.ImageData)" alt="Book Image" class="small-book-image img-thumbnail" />
                            </a>
                        </td>
                        <td>
                            <a class="a-cleanup" asp-controller="Store" asp-action="Details" asp-route-id="@item.Id">@item.books.Title</a>
                        </td>
                        <td>@item.books.Price.ToString("c")</td>
                        <td class="align-middle">
                            <div class="input-group">
                                <a asp-controller="Cart" asp-action="ReduceQuantity" asp-route-id="@item.books.Id" class="btn btn-outline-primary btn-sm"><i class="fa-solid fa-minus"></i></a>
                                <span class="badge bg-primary">@item.Quantity</span>
                                <a asp-controller="Cart" asp-action="IncreaseQuantity" asp-route-id="@item.books.Id" class="btn btn-outline-primary btn-sm"><i class="fa-solid fa-plus"></i></a>
                            </div>
                        </td>
                        <td>@bookTotal.ToString("c")</td>
                        <td>
                            <a asp-controller="Cart" asp-action="RemoveFromCart" asp-route-id="@item.books.Id" class="btn btn-outline-danger btn-sm">
                                <i class="fa-solid fa-trash"></i>
                            </a>
                        </td>
                    </tr>
                }
            </tbody>
            <tfoot>
                <tr>
                    <td colspan="4" class="text-end"><strong>Total:</strong></td>
                    <td colspan="2"><strong>@Model?.GetCartTotal().ToString("c")</strong></td>
                </tr>
            </tfoot>
        </table>
    </div>

    <div class="text-end">
        <a class="a-cleanup btn btn-success" asp-controller="Order" asp-action="Checkout">
            <i class="fa-solid fa-angles-right"></i> Checkout
        </a>
        <a class="a-cleanup btn btn-danger" asp-controller="Cart" asp-action="ClearCart">
            <i class="fa-solid fa-trash"></i> Empty Cart
        </a>
    </div>
}
else
{
    <h3 class="text-center">Cart is empty</h3>
}
